#{extends 'main.html' /}
#{set title:'Система тестирования' /}

#{header account:account  /}

<div id="chart" class="container p-t-50" style="min-width: 300px; height: 600px; margin: 0 auto">

</div>

#{set 'moreScripts'}
    #{script src:"highcharts.js" /}
#{/set}

<script type="text/javascript">
    #{set 'docReady'}
        #{get 'docReady' /}


    $('#chart').highcharts({
        title: {
            text: 'Теппинг-тест статистика'
        },
        subtitle: {
            text: 'по пользователю: ${account.getEmail()}'
        },
        xAxis: {
            type: 'datetime',
            labels: {
                rotation: -45,
                style: {
                    fontSize: '13px',
                    fontFamily: 'Verdana, sans-serif'
                }
            }
        },
        yAxis: {
            title: {
                text: 'Коэффициент силы нервной системы (КСНС)'
            },
            plotBands: [
                {
                    label: {
                        text: "Очень сильная"
                    },
                    color: '#D7F7E1',
                    from: 1.5,
                    to: 1000
                },
                {
                    label: {
                        text: "Сильно-слабая"
                    },
                    color: '#D7DDF7',
                    from: 1.2,
                    to: 1.49
                },
                {
                    label: {
                        text: "Средняя"
                    },
                    color: '#F7F1D7',
                    from: 0.8,
                    to: 1.19
                },
                {
                    label: {
                        text: "Слабо-сильная"
                    },
                    color: '#FCFFC5',
                    from: 0.5,
                    to: 0.79
                },
                {
                    label: {
                        text: "Очень слабая"
                    },
                    color: '#F7D7ED',
                    from: -1000,
                    to: 0.49
                },
            ],
        },
        legend: {
            enabled: false
        },
        tooltip: {
            pointFormat: 'Результат: <b>{point.y:.2f}</b>'
        },
        series: [{
            data: [
                #{list items:testResults, as:'res'}
                    [Date.UTC(${res.getResultDate().format('yyyy,MM-1,dd,HH,mm,ss')}), ${res.getResult()}],
                #{/list}
            ],
            dataLabels: {
                enabled: true,
                rotation: -90,
                color: '#FFFFFF',
                align: 'right',
                format: '{point.y:.2f}', // one decimal
                y: 10, // 10 pixels down from the top
                style: {
                    fontSize: '13px',
                    fontFamily: 'Verdana, sans-serif'
                }
            }
        }]
    });
    #{/set}
</script>